<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>macosx | mind the explanatory gap | Page 2</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<!--[if lt IE 9]>
	<script src="http://explanatorygap.net/wp-content/themes/twentythirteen/js/html5.js"></script>
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="mind the explanatory gap &raquo; Feed" href="http://explanatorygap.net/wp-content/plugins/really-static/static/feed/" />

<link rel="alternate" type="application/rss+xml" title="mind the explanatory gap &raquo; macosx Category Feed" href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/feed/" />
<link rel='stylesheet' id='wpcf-css'  href='http://explanatorygap.net/wp-content/plugins/wp-contact-form/wpcf.css?ver=20110218' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='http://explanatorygap.net/wp-content/themes/twentythirteen/fonts/genericons.css?ver=2.09' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-style-css'  href='http://explanatorygap.net/wp-content/themes/twentythirteen/style.css?ver=2013-07-18' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='http://explanatorygap.net/wp-content/themes/twentythirteen/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.7.3'></script>
<meta name="generator" content="WordPress 3.9.1 - really-static 0.5" />
<link rel="stylesheet" href="http://explanatorygap.net/wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"  type="text/css" />	<style type="text/css" id="twentythirteen-header-css">
			.site-header {
			background: url(http://explanatorygap.net/wp-content/themes/twentythirteen/images/headers/star.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		</style>
	<!-- Google Analytics Tracking by Google Analyticator 6.4.7.3: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">
                var analyticsFileTypes = [''];
                            var analyticsSnippet = 'enabled';
                var analyticsEventTracking = 'enabled';
            </script>
<script type="text/javascript">
	var _gaq = _gaq || [];
  
	_gaq.push(['_setAccount', 'UA-719433-1']);
    _gaq.push(['_addDevId', 'i9k95']); // Google Analyticator App ID with Google
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</head>

<body class="archive paged category category-macosx category-6 paged-2 category-paged-2 single-author">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
			<a class="home-link" href="http://explanatorygap.net/wp-content/plugins/really-static/static/" title="mind the explanatory gap" rel="home">
				<h1 class="site-title">mind the explanatory gap</h1>
				<h2 class="site-description">many a slip &#039;twixt mind and lip&#8230;</h2>
			</a>

			<div id="navbar" class="navbar">
				<nav id="site-navigation" class="navigation main-navigation" role="navigation">
					<h3 class="menu-toggle">Menu</h3>
					<a class="screen-reader-text skip-link" href="#content" title="Skip to content">Skip to content</a>
					<div class="nav-menu"><ul><li class="page_item page-item-2"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/about/">About/Contact</a></li><li class="page_item page-item-278"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/os-x-puppet-pkgs/">OS X Puppet pkgs</a></li></ul></div>
					<form role="search" method="get" class="search-form" action="http://explanatorygap.net/wp-content/plugins/really-static/static/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>				</nav><!-- #site-navigation -->
			</div><!-- #navbar -->
		</header><!-- #masthead -->

		<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">

					<header class="archive-header">
				<h1 class="archive-title">Category Archives: macosx</h1>

							</header><!-- .archive-header -->

										
<article id="post-151" class="post-151 post type-post status-publish format-standard hentry category-macosx">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2008/01/26/using-managed-preferences-in-the-local-ds-domain-on-macs/" rel="bookmark">Using managed preferences in the local DS domain on Macs</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2008/01/26/using-managed-preferences-in-the-local-ds-domain-on-macs/" title="Permalink to Using managed preferences in the local DS domain on Macs" rel="bookmark"><time class="entry-date" datetime="2008-01-26T09:14:08+00:00">January 26, 2008</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><a href="http://www.afp548.com/article.php?story=using-mcx-in-the-dslocal-domain">Longer article up at AFP548.com</a>, but basically I&#8217;ve been playing around a fair bit with MCX in DSLocal lately, and there are a lot of interesting applications&#8230;.</p>
<p>It&#8217;s <b>so</b> nice to be able to just manage plists now&#8230;. NetInfo I miss you not at all.</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2008/01/26/using-managed-preferences-in-the-local-ds-domain-on-macs/#comments" title="Comment on Using managed preferences in the local DS domain on Macs">View all 2 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-150" class="post-150 post type-post status-publish format-standard hentry category-macosx category-macosxserver">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2008/01/25/post-macworld-2008/" rel="bookmark">Post Macworld 2008</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2008/01/25/post-macworld-2008/" title="Permalink to Post Macworld 2008" rel="bookmark"><time class="entry-date" datetime="2008-01-25T02:18:21+00:00">January 25, 2008</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts in macosxserver" rel="category tag">macosxserver</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So my webhost managed to mess up all htacess files and thus lock me out of my blog for a couple of weeks. I considered briefly posting via MySQL, but then dragged myself back into the realm of the sane and just waited it out.  Apologies to the comments that were awaiting moderation&#8230;.  My resolution is to actually blog more this year, so I&#8217;ve started trying out MarsEdit to see if being able to work offline improves the situation&#8230;.</p>
<p>Another Macworld is over. To be honest, this one was a bit too hectic to really enjoy as a pure punter, and besides, I missed what was a brilliant match where <a href="http://content-usa.cricinfo.com/ausvind/content/story/332219.html">India broke Australia&#8217;s record equalling winning streak</a> in Perth.</p>
<p>Schoun Regan and I did the two day <a href="http://www.macworldexpo.com/conference_program/power-tools-conference/pg-beyond-box-advanced-mac-os-x-server-techniques">PowerTools conference on Advanced OS X Serve</a>r, then Jeff McCune and I did a <a href="http://code.google.com/p/puppet-mw08/">shorter presentation and demo on Puppet</a> that seems to have provoked some interest in the MacEnterprise crowd.</p>
<p>The few other talks I managed to make it to were quite good, even given the difficulty of catering to the very wide range of technical ability in a Macworld crowd&#8230; I thoroughly enjoyed Andrina Kelly&#8217;s <a href="http://www.macworldexpo.com/conference_program/macit-conference/lucid-system-administration-clear-thoughts-very-complex-occupati">Lucid System Administration</a> presentation, some of our Google techs were inspired by Kevin White&#8217;s <a href="http://www.macworldexpo.com/conference_program/macit-conference/neutered-admins-creating-limited-administrator-account-within-ma">Neutered Admins</a> talk, and I heard lots of good reports about Greg Neagle and Philip Rhinehart&#8217;s <a href="http://www.macworldexpo.com/conference_program/power-tools-conference/ph-system-imaging-and-deployment">System Imaging and Deployment</a> two day session.</p>
<p>The two highlights of the week for me were firstly that Joel managed to work the <a href="http://www.shaveeverywhere.com">optical inch</a> into his Directory Services talk. Nice work&#8230;.</p>
<p>Secondly would have to have been seeing Devo in the flesh. Thanks to Dave Pugh (you need to get that blog going Dave&#8230;), I now have much better photos than my mediocre camera gave&#8230;.</p>
<p>Devo were simply awesome. I was prepared to have all my illusions shattered&#8230; but they put on an awesome performance&#8230;.</p>
<p><embed src="http://picasaweb.google.com/s/c/bin/slideshow.swf" type="application/x-shockwave-flash" flashvars="host=picasaweb.google.com&amp;RGB=0x000000&amp;feed=http%3A%2F%2Fpicasaweb.google.com%2Fdata%2Ffeed%2Fapi%2Fuser%2Fnigel.kersten%2Falbumid%2F5159076479880112529%3Fkind%3Dphoto%26alt%3Drss" pluginspage="http://www.macromedia.com/go/getflashplayer" height="267" width="400"></embed></p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2008/01/25/post-macworld-2008/#comments" title="Comment on Post Macworld 2008">View all 3 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-148" class="post-148 post type-post status-publish format-standard hentry category-macosx category-software-and-scripts">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/11/22/wrapping-defaults-to-be-more-flexible/" rel="bookmark">Wrapping &#8216;defaults&#8217; to be more flexible&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/11/22/wrapping-defaults-to-be-more-flexible/" title="Permalink to Wrapping &#8216;defaults&#8217; to be more flexible&#8230;" rel="bookmark"><time class="entry-date" datetime="2007-11-22T07:19:19+00:00">November 22, 2007</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts in software and scripts" rel="category tag">software and scripts</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So I don&#8217;t know about any of you, gentle readers, but &#8216;defaults&#8217; really gives me the shits sometimes.</p>
<p>Exhibit A:</p>
<pre>/ $ defaults read /Library/Preferences/com.apple.loginwindow.plist
2007-11-21 13:12:04.288 defaults[97501:10b]
Domain com.apple.loginwindow.plist does not exist
/ $ defaults read /Library/Preferences/com.apple.loginwindow
(snip actual working output)</pre>
<p>Exhibit B:</p>
<pre>  / $ cd /Library/Preferences
/Library/Preferences $ defaults read ./com.apple.loginwindow.plist
2007-11-21 13:13:24.327 defaults[97540:10b]
Domain ./com.apple.loginwindow.plist does not exist
/Library/Preferences $ defaults read ./com.apple.loginwindow
2007-11-21 13:13:25.799 defaults[97546:10b]
Domain ./com.apple.loginwindow does not exist</pre>
<p>This really annoys me, that &#8216;defaults&#8217; firstly doesn&#8217;t accept the full path to the plist, when other tools like &#8216;launchctl&#8217; do, and requires that you strip off the &#8220;.plist&#8221; from the end, and secondly, that you can&#8217;t use relative paths.</p>
<p>This annoyed me so much that I decided to finally do something about it. This function resolves both problems.</p>
<pre>function defread { defaults read $(echo "$@" | sed "s|\./|`pwd`/|g" | sed "s|.plist||g"); }</pre>
<p>And now we can do:</p>
<pre>/ $ defread /Library/Preferences/com.apple.loginwindow.plist
/ $ cd /Library/Preferences
/Library/Preferences $ defread ./com.apple.loginwindow.plist
</pre>
<p>or even:</p>
<pre>
/Library/Preferences $ defread ./com.apple.loginwindow.plist SHOWFULLNAME
1
</pre>
<p>mmmm.</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/11/22/wrapping-defaults-to-be-more-flexible/#comments" title="Comment on Wrapping &#8216;defaults&#8217; to be more flexible&#8230;">View all 5 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-137" class="post-137 post type-post status-publish format-standard hentry category-macosx category-software-and-scripts">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/30/making-parts-of-the-filesystem-readwrite-from-netboot/" rel="bookmark">Making parts of the filesystem read/write from NetBoot</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/30/making-parts-of-the-filesystem-readwrite-from-netboot/" title="Permalink to Making parts of the filesystem read/write from NetBoot" rel="bookmark"><time class="entry-date" datetime="2006-10-30T10:20:37+00:00">October 30, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts in software and scripts" rel="category tag">software and scripts</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So we use NetBoot (well NetInstall really) a lot here for diagnostics and as a platform for radminding machines from.</p>
<p>I&#8217;ve recently been refactoring our entire Radmind setup here, mainly because we&#8217;ve been using it for so long that we&#8217;re not actually taking advantage of any of the features Radmind has introduced in the last couple of years.</p>
<p>As part of this, I&#8217;ve been trying to avoid using our existing radmind wrapper script, and instead to try and do everything using the supplied ra.sh script, with appropriately configured preapply/postapply scripts, which is working rather nicely so far.</p>
<p>Anyway, to get to the point of this post, I worked out that if I wanted to use ra.sh while booted from a NetInstall image, I really needed /var/radmind to be read/write, which it isn&#8217;t.</p>
<p>After poking around through the /etc/rc.cdrom script, I noticed that Apple do things this way:</p>
<pre>
echo "Creating RAM Disk for /private/tmp"
dev=`hdik -drivekey system-image=yes -nomount ram://2048 `  # 1MB
if [ $? -eq 0 ] ; then
  newfs $dev
  mount -o union $dev /private/tmp
fi
</pre>
<p>which is all rather dandy when you think about it. hdik is creating a 1Mb RAM disk, and then it is mounted as a union mount at /private/tmp, effectively making that directory read/write.</p>
<p>The only problem is that our Radmind transcripts take up about 40-50Mb, and you can&#8217;t use hdik to make a RAM disk of that size, which I imagine is a limitation of the fact that hdik is intended for rather lightweight disk images, being an in-kernel tool and all.</p>
<p>So I started poking around trying to work out how to use hdiutil to accomplish the same thing, but it turns out that hdid is actually far simpler. Rather than being an in-kernel tool, it will actually use the DiskImages.framework, which means the disk image limitations don&#8217;t hold.</p>
<p>So here&#8217;s what I add to /etc/rc.cdrom.postWS to create 96Mb of r/w space in /var/radmind</p>
<pre>
# Create r/w mount for /var/radmind and populate it with the file structure
echo "Creating RAM disk for /var/radmind"
dev=`hdid -nomount ram://196608` # 96Mb
if [ $? -eq 0 ]; then
  newfs $dev
  mount -o union $dev /var/radmind
  mkdir /var/radmind/cert
  mkdir /var/radmind/client
  mkdir /var/radmind/postapply
  mkdir /var/radmind/preapply
fi
</pre>
<p>and now everything is peachy.</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/30/making-parts-of-the-filesystem-readwrite-from-netboot/#comments" title="Comment on Making parts of the filesystem read/write from NetBoot">View all 4 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-132" class="post-132 post type-post status-publish format-standard hentry category-macosx category-software-and-scripts">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/28/wtfdtfd-a-wiki-like-system-for-the-mac-os-x-file-system/" rel="bookmark">wtfdtfd ? : A wiki-like system for the Mac OS X file system&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/28/wtfdtfd-a-wiki-like-system-for-the-mac-os-x-file-system/" title="Permalink to wtfdtfd ? : A wiki-like system for the Mac OS X file system&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-09-28T07:24:58+00:00">September 28, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts in software and scripts" rel="category tag">software and scripts</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So I&#8217;m rather close to deploying a closed beta test of something that I&#8217;ve been working on in my spare time for a while now.</p>
<p>The basic idea is that you can browse a copy of the Mac OS X filesystem, and any registered user can attach &#8220;annotations&#8221; to a file or directory explaining what that file does. This is done with a wiki-like system, so any user can edit the annotations, or roll back to previous versions.</p>
<p>The main impetus behind this was me trying to train up someone at work to take over the radmind setup we have.  It really doesn&#8217;t take long to learn how something like radmind works, but what does take time is working out exactly what files <b>do</b>, and whether you should include a particular file in any given transcript or not.</p>
<p>Thus the name &#8220;wtfdtfd&#8221; ==  &#8220;wtf does this file do?&#8221; &#8230;</p>
<p>It&#8217;s also been a way for me to finally start a proper project in Ruby on Rails, which I&#8217;ve been meaning to do for a while now.</p>
<p>I&#8217;ll be opening up the source to interested people after I deploy it, so if you&#8217;re interested in taking part in either coding or a private beta, send me an email by clicking on the &#8220;About&#8221; tab at the top.</p>
<p><b>Edit</b>:<br />
If you want to take part, the easiest way is to subscribe to the dev-list, which you can do by clicking on this link.</p>
<p>
<a href="mailto:dev-list-request@wtfdtfd.explanatorygap.net?subject=subscribe">Subscribe to wtfdtfd dev-list</a></p>
<p>Thanks for the input people, it&#8217;s looking good&#8230;. :)</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/28/wtfdtfd-a-wiki-like-system-for-the-mac-os-x-file-system/#comments" title="Comment on wtfdtfd ? : A wiki-like system for the Mac OS X file system&#8230;">View all 3 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-90" class="post-90 post type-post status-publish format-standard hentry category-macosx">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/07/14/plistbuddy-is-the-shiznit/" rel="bookmark">PlistBuddy is the shiznit..</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/07/14/plistbuddy-is-the-shiznit/" title="Permalink to PlistBuddy is the shiznit.." rel="bookmark"><time class="entry-date" datetime="2006-07-14T00:24:17+00:00">July 14, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So I&#8217;ve been meaning to start using PlistBuddy for a while, and this morning I ran into a real need for it.</p>
<p>Unbeknownst to me, we had a problem with our imaging system where a machine would be freshly imaged, and it would retain the LocalHostName and ComputerName of the imaged machine until the next reboot.</p>
<p>(We normally set these values to &#8220;hostname -s&#8221; as part of a StartupItem)</p>
<p>Anyway, I wanted to set these values when machines are booted from our custom NetInstall image, and quite frankly, using &#8220;defaults&#8221; with nested dictionaries can sometimes either be an absolute pain in the ass, or impossible. </p>
<p>Obviously someone at Apple realised this a while ago, which is why they invented PlistBuddy. If you do &#8220;locate PlistBuddy&#8221; from a shell, you&#8217;re likely to see it in all sorts of Apple packages, and I feel perfectly comfortable simply stealing one of them&#8230;</p>
<p>PlistBuddy lets you easily write nested values and merge dictionaries into each other.</p>
<p>Here&#8217;s the two liner that lets you set the relevant values (as root/sudo etc)<br />
</p>
<pre>
$ PlistBuddy -c "Set :System:Network:HostNames:LocalHostName $(hostname -s)"  \
/Library/Preferences/SystemConfiguration/preferences.plist 
$ /PlistBuddy -c "Set :System:System:ComputerName $(hostname -s)" \
/Library/Preferences/SystemConfiguration/preferences.plist 
</pre>
<p>And for us we just point it to /Volumes/System/Library/&#8230; etc as that&#8217;s where the SOE partition is while NetBooting.</p>
<p>Much nicer than using defaults&#8230;</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/07/14/plistbuddy-is-the-shiznit/#comments" title="Comment on PlistBuddy is the shiznit..">View all 7 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-91" class="post-91 post type-post status-publish format-standard hentry category-macosx">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/06/08/moving-the-hibernate-image-file-on-a-macbookpro/" rel="bookmark">Moving the hibernate image file on a MacBookPro&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/06/08/moving-the-hibernate-image-file-on-a-macbookpro/" title="Permalink to Moving the hibernate image file on a MacBookPro&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-06-08T20:26:23+00:00">June 8, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So I like to partition my Macs so that my user directory is on a different partition to the system drive.<br />
I got kind of frustrated when I got my MacBook Pro and realised that due to having 2Gb of RAM, the hibernate settings by default were taking up an extra 2Gb on my system partition with the sleep image file at /var/vm/sleepimage.</p>
<p>After poking around with pmset for a while, I realised that you can move the image file&#8230;</p>
<pre>
sudo pmset -a hibernatefile /Volumes/OtherVolume/sleepimage
</pre>
<p>Then trash /var/vm/sleepimage, and all seems hunky-dory&#8230;</p>
<p>There are some other useful settings I&#8217;ve seen people mention on the web, like setting:</p>
<pre>
sudo pmset -a  hibernatemode x
</pre>
<p>Where x is an integer meaning:<br />
</p>
<ul>
<li>0 &#8211; disable hibernate mode.</li>
<li>1 &#8211; hibernate when shutting the lid instead of sleeping.</li>
<li>3 &#8211; normal hibernate settings.</li>
<li>5 &#8211; hibernate when shutting the lid instead of sleeping (with secure virtual memory turned on)</li>
<li>7 &#8211; normal hibernate settings (with secure virtual memory turned on)</li>
</ul>
<p>
I wonder what the even numbers do&#8230;</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/06/08/moving-the-hibernate-image-file-on-a-macbookpro/#comments" title="Comment on Moving the hibernate image file on a MacBookPro&#8230;">View all 5 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-93" class="post-93 post type-post status-publish format-standard hentry category-macosx">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/04/03/how-os-x-launches-applications/" rel="bookmark">How OS X launches Applications&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/04/03/how-os-x-launches-applications/" title="Permalink to How OS X launches Applications&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-04-03T18:42:32+00:00">April 3, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p><b>Quickie:</b> A very nice article on <a href="http://0xfe.blogspot.com/2006/03/how-os-x-executes-applications.html">how OS X launches applications</a> and a follow-up <a href="http://0xfe.blogspot.com/2006/03/qa-how-os-x-executes-applications.html">Q &#038; A</a>.</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/04/03/how-os-x-launches-applications/#respond" title="Comment on How OS X launches Applications&#8230;"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-94" class="post-94 post type-post status-publish format-standard hentry category-macosx category-macosxserver">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/03/30/greg-neagles-managing-os-x-blog/" rel="bookmark">Greg Neagle&#39;s Managing OS X blog&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/03/30/greg-neagles-managing-os-x-blog/" title="Permalink to Greg Neagle&#039;s Managing OS X blog&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-03-30T20:30:51+00:00">March 30, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts in macosxserver" rel="category tag">macosxserver</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>I&#8217;ve just added a link to it in the side column, but it&#8217;s well worthwhile checking out Greg Neagle&#8217;s <a href="http://managingosx.wordpress.com/">Managing OS X</a> blog.</p>
<p>There are <a>getting the screensaver to work over the loginwindow</a>, <a href="http://managingosx.wordpress.com/2006/03/15/portable-home-directories-without-open-directory/">several</a>, <a href="http://managingosx.wordpress.com/2006/03/16/portable-home-directories-without-open-directory-part-2/">really</a>, <a href="http://managingosx.wordpress.com/2006/03/16/portable-home-directories-without-open-directory-part-2-2/">good</a> <a href="http://managingosx.wordpress.com/2006/03/22/more-on-portable-home-directories/">posts</a> on using Portable Home Directories without Open Directory.</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/03/30/greg-neagles-managing-os-x-blog/#respond" title="Comment on Greg Neagle&#039;s Managing OS X blog&#8230;"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-96" class="post-96 post type-post status-publish format-standard hentry category-macosx category-software-and-scripts">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/02/09/forcing-mobile-home-directories-to-another-partition/" rel="bookmark">Forcing Mobile Home Directories to another partition.</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/02/09/forcing-mobile-home-directories-to-another-partition/" title="Permalink to Forcing Mobile Home Directories to another partition." rel="bookmark"><time class="entry-date" datetime="2006-02-09T01:19:53+00:00">February 9, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts in software and scripts" rel="category tag">software and scripts</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So we never keep our user&#8217;s local home directories at /Users, primarily so that we can always blow away the boot partition with our imaging system without worrying about user data.</p>
<p>We&#8217;ve started using Mobile Accounts for some of our desktop users due to some limitations in the OS X Server AFP server, and it was kind of bugging me that new Mobile Accounts would always get created at /Users/username, and we&#8217;d have to faff around with niutil in order to change this after the account had been created.</p>
<p>So I&#8217;ve managed to work out a LoginHook that will force Mobile Accounts to another location, even on the first login&#8230; I&#8217;m just showing part of it here, the bit that deals with such users, so some bits might strike you as the long way round&#8230;</p>
<pre>
#!/bin/bash
#

homes_disk="/Volumes/Storage"
local_homes="/Volumes/Storage/Users"

lookup_local=$(niutil -read . /users/$1 2> /dev/null)
if [ "$lookup_local" != "" ]; then
        is_local=1;
else
        is_local=0;
fi

# If they are a local user.
if [ $is_local -eq 1 ]; then
auth_prop=$(niutil -readprop . /users/$1 authentication_authority 2> /dev/null \
				   | grep LocalCachedUser)

# If they are a mobile user.
if [ "$auth_prop" != "" ]; then
  logger "LoginHook: Started for Mobile Account - $1"
  home_location=$(niutil -readprop . /users/$1 home)
  # If their home directory hasn't been moved to $local_homes yet.
  if [ "$home_location" != "$local_homes/$1" ]; then
      logger "LoginHook: Moving home from /Users/$1 to $local_homes/$1"
      if [ -e $homes_disk ]; then
        mkdir -p $local_homes
        chmod 1755 $local_homes
        chown root:admin $local_homes
        /System/Library/CoreServices/mcxd.app/Contents/Resources/MCXCacher \
        -U $1 -h $local_homes/$1
        ditto /Users/$1 $local_homes/$1
        rm -Rf /Users/$1
        sleep 2
        lookupd -flushcache
        sleep 2
      else
        logger "LoginHook: ERROR! Could not find $homes_disk"
      fi
  fi
    logger "LoginHook: Finished for Mobile Account - $1"
else
		logger "LoginHook: Not running for Local non-Mobile Account - $1"
fi

# If they are not local, they must be a network user.
else        
	logger "LoginHook: Started for Network Account - $1"
	# Do your stuff for network users here.
	logger "LoginHook: Finished for Network Account - $1"
fi
</pre>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/02/09/forcing-mobile-home-directories-to-another-partition/#respond" title="Comment on Forcing Mobile Home Directories to another partition."><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
			
				<nav class="navigation paging-navigation" role="navigation">
		<h1 class="screen-reader-text">Posts navigation</h1>
		<div class="nav-links">

						<div class="nav-previous"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/page/3.html" ><span class="meta-nav">&larr;</span> Older posts</a></div>
			
						<div class="nav-next"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/index.html" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
			
		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
		
		</div><!-- #content -->
	</div><!-- #primary -->


		</div><!-- #main -->
		<footer id="colophon" class="site-footer" role="contentinfo">
				<div id="secondary" class="sidebar-container" role="complementary">
		<div class="widget-area">
			<aside id="pages-2" class="widget widget_pages"><h3 class="widget-title">Pages</h3>		<ul>
			<li class="page_item page-item-2"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/about/">About/Contact</a></li>
<li class="page_item page-item-278"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/os-x-puppet-pkgs/">OS X Puppet pkgs</a></li>
		</ul>
		</aside><aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://explanatorygap.net/wp-content/plugins/really-static/static/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="tweetbox" class="widget tweetbox_widget"><h3 class="widget-title">Latest Tweets</h3><script type="text/javascript" src="http://explanatorygap.net/wp-content/plugins/tweetbox/tweetbox.js"></script><script>getTweets('nigelkersten', 3, '')</script><div id="tweetboxtweets">Fetching latest tweets...</div></aside><aside id="categories-1" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-5"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/nix/" title="View all posts filed under *nix">*nix</a>
</li>
	<li class="cat-item cat-item-6 current-cat"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts filed under macosx">macosx</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts filed under macosxserver">macosxserver</a>
</li>
	<li class="cat-item cat-item-13"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/puppet/" title="View all posts filed under puppet">puppet</a>
</li>
	<li class="cat-item cat-item-15"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/python/" title="View all posts filed under python">python</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/ramblings/" title="View all posts filed under ramblings">ramblings</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/snippets/" title="Snippets">Snippets</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts filed under software and scripts">software and scripts</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/wp-login.php">Log in</a></li>
			<li><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/feed/" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</aside><aside id="linkcat-10" class="widget widget_links"><h3 class="widget-title">Mac Dev Blogs</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://ridiculousfish.com/blog/">Ridiculous Fish</a></li>
<li><a href="http://www.theocacao.com/" title="Scott Stevenson&#8217;s blog">theocacao.com</a></li>

	</ul>
</aside>
<aside id="linkcat-8" class="widget widget_links"><h3 class="widget-title">Mac Tech Blogs</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://bynkii.com/" title="John C. Welch&#8217;s blog&#8230; the reason God invented the middle finger&#8230;">bynkii.com</a></li>
<li><a href="http://arstechnica.com/staff/fatbits.ars" title="John Siracusa&#8217;s Journal">fatbits</a></li>
<li><a href="http://iamleeg.blogspot.com/" title="Graham Lee&#8217;s blog&#8230; lots of Darwin and Openstep.">i am leeg</a></li>
<li><a href="http://managingosx.wordpress.com/" title="Greg Neagle&#8217;s Managing OS X blog">managing os x</a></li>
<li><a href="http://northstarlabs.net" title="Jeff McCune&#8217;s sysadmin blog">northstarlabs.net</a></li>
<li><a href="http://www.radiotope.com/writing/" title="Edward Marczak&#8217;s blog&#8230; the oneness of tech..">tech zendo</a></li>
<li><a href="http://www.dreness.com/blog/" title="Andre&#8217;s Mac geek blog&#8230;">the bits</a></li>
<li><a href="http://yourmacguy.wordpress.com/" title="Peter Bukowinski&#8217;s blog">Your Mac Guy</a></li>

	</ul>
</aside>
<aside id="linkcat-9" class="widget widget_links"><h3 class="widget-title">Mac Technical Sites</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.afp548.com" title="We put the M in RTFM&#8230;">AFP548.com</a></li>
<li><a href="http://www.macenterprise.org" title="The MacEnterprise project is a community of IT professionals sharing information and solutions to support Macs in an enterprise.">MacEnterprise.org</a></li>
<li><a href="http://xsanity.com/">xsanity</a></li>

	</ul>
</aside>
<aside id="linkcat-12" class="widget widget_links"><h3 class="widget-title">Social</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://yumamino.com/" title="Tane Potaka&#8217;s blog">Yumamino</a></li>

	</ul>
</aside>
		</div><!-- .widget-area -->
	</div><!-- #secondary -->

			<div class="site-info">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/masonry.min.js?ver=3.1.2'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-content/themes/twentythirteen/js/functions.js?ver=2013-07-18'></script>
</body>
</html>
<!-- Dynamic Page Served (once) in 0.343 seconds -->
