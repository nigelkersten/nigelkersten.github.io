<!DOCTYPE html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) | !(IE 8)  ]><!-->
<html lang="en-US">
<!--<![endif]-->
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width">
	<title>mind the explanatory gap | many a slip &#039;twixt mind and lip&#8230; | Page 5</title>
	<link rel="profile" href="http://gmpg.org/xfn/11">
		<!--[if lt IE 9]>
	<script src="http://explanatorygap.net/wp-content/themes/twentythirteen/js/html5.js"></script>
	<![endif]-->
	<link rel="alternate" type="application/rss+xml" title="mind the explanatory gap &raquo; Feed" href="http://explanatorygap.net/wp-content/plugins/really-static/static/feed/" />

<link rel='stylesheet' id='wpcf-css'  href='http://explanatorygap.net/wp-content/plugins/wp-contact-form/wpcf.css?ver=20110218' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-fonts-css'  href='//fonts.googleapis.com/css?family=Source+Sans+Pro%3A300%2C400%2C700%2C300italic%2C400italic%2C700italic%7CBitter%3A400%2C700&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='genericons-css'  href='http://explanatorygap.net/wp-content/themes/twentythirteen/fonts/genericons.css?ver=2.09' type='text/css' media='all' />
<link rel='stylesheet' id='twentythirteen-style-css'  href='http://explanatorygap.net/wp-content/themes/twentythirteen/style.css?ver=2013-07-18' type='text/css' media='all' />
<!--[if lt IE 9]>
<link rel='stylesheet' id='twentythirteen-ie-css'  href='http://explanatorygap.net/wp-content/themes/twentythirteen/css/ie.css?ver=2013-07-18' type='text/css' media='all' />
<![endif]-->
<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/jquery/jquery.js?ver=1.11.0'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.2.1'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-content/plugins/google-analyticator/external-tracking.min.js?ver=6.4.7.3'></script>
<meta name="generator" content="WordPress 3.9.1 - really-static 0.5" />
<link rel="stylesheet" href="http://explanatorygap.net/wp-content/plugins/source-code-syntax-highlighting-plugin-for-wordpress/geshi.css"  type="text/css" />	<style type="text/css" id="twentythirteen-header-css">
			.site-header {
			background: url(http://explanatorygap.net/wp-content/themes/twentythirteen/images/headers/star.png) no-repeat scroll top;
			background-size: 1600px auto;
		}
		</style>
	<!-- Google Analytics Tracking by Google Analyticator 6.4.7.3: http://www.videousermanuals.com/google-analyticator/ -->
<script type="text/javascript">
                var analyticsFileTypes = [''];
                            var analyticsSnippet = 'enabled';
                var analyticsEventTracking = 'enabled';
            </script>
<script type="text/javascript">
	var _gaq = _gaq || [];
  
	_gaq.push(['_setAccount', 'UA-719433-1']);
    _gaq.push(['_addDevId', 'i9k95']); // Google Analyticator App ID with Google
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
</head>

<body class="home blog paged paged-5 single-author">
	<div id="page" class="hfeed site">
		<header id="masthead" class="site-header" role="banner">
			<a class="home-link" href="http://explanatorygap.net/wp-content/plugins/really-static/static/" title="mind the explanatory gap" rel="home">
				<h1 class="site-title">mind the explanatory gap</h1>
				<h2 class="site-description">many a slip &#039;twixt mind and lip&#8230;</h2>
			</a>

			<div id="navbar" class="navbar">
				<nav id="site-navigation" class="navigation main-navigation" role="navigation">
					<h3 class="menu-toggle">Menu</h3>
					<a class="screen-reader-text skip-link" href="#content" title="Skip to content">Skip to content</a>
					<div class="nav-menu"><ul><li class="page_item page-item-2"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/about/">About/Contact</a></li><li class="page_item page-item-278"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/os-x-puppet-pkgs/">OS X Puppet pkgs</a></li></ul></div>
					<form role="search" method="get" class="search-form" action="http://explanatorygap.net/wp-content/plugins/really-static/static/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form>				</nav><!-- #site-navigation -->
			</div><!-- #navbar -->
		</header><!-- #masthead -->

		<div id="main" class="site-main">

	<div id="primary" class="content-area">
		<div id="content" class="site-content" role="main">
		
										
<article id="post-141" class="post-141 post type-post status-publish format-standard hentry category-macosxserver">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/03/03/psa-a-fix-to-certain-afp-problems/" rel="bookmark">PSA: A fix to certain AFP problems&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/03/03/psa-a-fix-to-certain-afp-problems/" title="Permalink to PSA: A fix to certain AFP problems&#8230;" rel="bookmark"><time class="entry-date" datetime="2007-03-03T16:08:17+00:00">March 3, 2007</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts in macosxserver" rel="category tag">macosxserver</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>Seeing as how half the visitors to this site still seem to coming here via AFP-related searches in Google&#8230; this is something I&#8217;d noticed a while ago, but simply started adding more RAM as I had more lying around.</p>
<p>Find operations on AFP servers can really slow down the system. Apple have now produced a nice techinfo article with a really simple fix.:</p>
<p><a href="http://docs.info.apple.com/article.html?artnum=305167">Mac OS X Server (Universal) 10.4.7 and later: May become unresponsive when clients search mounted network volumes</a></p>
<p>Short, and to the point, but I&#8217;m still not sure if there&#8217;s a decent reason why they&#8217;re not telling us to put this sort of a change in /etc/sysctl.conf instead&#8230;</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/03/03/psa-a-fix-to-certain-afp-problems/#respond" title="Comment on PSA: A fix to certain AFP problems&#8230;"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-140" class="post-140 post type-post status-publish format-standard hentry category-macosxserver">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/03/02/simple-create-mobile-user-utility/" rel="bookmark">Simple &#8220;Create Mobile User&#8221; utility.</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/03/02/simple-create-mobile-user-utility/" title="Permalink to Simple &#8220;Create Mobile User&#8221; utility." rel="bookmark"><time class="entry-date" datetime="2007-03-02T09:18:56+00:00">March 2, 2007</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts in macosxserver" rel="category tag">macosxserver</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So after a couple of people requested this on the MacEnterprise mailing list&#8230;.</p>
<p>This is a really simple AppleScript Studio application that allows you to create a Mobile User Account with a local home directory other than &#8220;/Users/nigelkersten&#8221;.</p>
<p style="text-align: center"><img src="http://explanatorygap.net/wp-content/plugins/really-static/static/sw/CreateMobileUserScreenshot.jpg" border="0" height="145" width="402" /></p>
<p>To get started&#8230;.</p>
<ul>
<li>Open up the Xcode project.</li>
<li>Edit &#8220;ldapDomain&#8221; and &#8220;pathToHomes&#8221; to reflect your LDAP domain and where you want the home directories to go to.</li>
<li>Make sure you leave the trailing slash in for &#8216;pathToHomes&#8217;, otherwise you&#8217;ll end up with home directories like: &#8220;/Volumes/Storage/Usersnigelkersten&#8221;</li>
<li>Compile it and run it.</li>
</ul>
<p>When you launch it, it will spend a few seconds collecting usernames so that you can auto-complete the combo box.<br />
I&#8217;ve left a grep statement in there to illustrate how you can filter out unwanted usernames:</p>
<pre>
do shell script "dscl  " &amp; ldapDomain &amp; "  -list /Users | egrep -v '^(z|Z)[0-9]{7}' |egrep -v '^vpn_*' | grep -v admin  &gt; /tmp/ldapusers.txt"</pre>
<p>the section:<br />
<code>egrep -v '^(z|Z)[0-9]{7}'</code> filters out our student ids, which are &#8216;z&#8217; followed by 7 numbers.<br />
If you wanted to  pull that filter out, just change it to:</p>
<pre>
do shell script "dscl  " &amp; ldapDomain &amp; "  -list /Users | egrep -v '^vpn_*' | grep -v admin  &gt; /tmp/ldapusers.txt"</pre>
<p>and the same goes for the other filters, which remove admin accounts in my area and the vpn user accounts that get created.</p>
<p>No guarantees about this app. It&#8217;s a rather quick and dirty hack, and you&#8217;re welcome to do whatever you want with it. I&#8217;d appreciate seeing any improvements you make to it however.</p>
<p><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/sw/CreateMobileUserDist.zip">You can download it here</a></p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/03/02/simple-create-mobile-user-utility/#comments" title="Comment on Simple &#8220;Create Mobile User&#8221; utility.">View all 3 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-139" class="post-139 post type-post status-publish format-standard hentry category-ramblings category-uncategorized">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/01/29/leaving-sydney-moving-to-the-usa/" rel="bookmark">Leaving Sydney&#8230; moving to the USA</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/01/29/leaving-sydney-moving-to-the-usa/" title="Permalink to Leaving Sydney&#8230; moving to the USA" rel="bookmark"><time class="entry-date" datetime="2007-01-29T06:42:38+00:00">January 29, 2007</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/ramblings/" title="View all posts in ramblings" rel="category tag">ramblings</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/uncategorized/" title="View all posts in Uncategorized" rel="category tag">Uncategorized</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So some of the people I know who read this already know&#8230; but it looks like I&#8217;ll be moving the family over to Silicon Valley in the next couple of months.</p>
<p>I&#8217;ve accepted a position at Google HQ in Mountain View (huzzah!) doing Mac/Linux sysadmin stuff, which means several things&#8230;</p>
<p>We&#8217;re finally getting married tomorrow, as we&#8217;ll be doing it on an <a href="http://canberra.usembassy.gov/consular/visa-e3.html">E-3 visa</a>, and the US doesn&#8217;t recognize de facto/common law relationships&#8230; I think our daughter is the most excited person involved&#8230; :)  The process doesn&#8217;t look too bad, and luckily Andrew Pollock has <a href="http://blog.andrew.net.au/2005/11/24">put up some useful info</a> about his experiences going through the same situation. I&#8217;ll add some more posts here if anything has changed&#8230;</p>
<p>We&#8217;re not doing much of a ceremony, but we&#8217;ll combine something with our farewell party here in Sydney before we leave.</p>
<p>We&#8217;ll also be looking for someone to replace my current position as Senior Technical Officer at the <a href="http://www.cofa.unsw.edu.au">College of Fine Arts, UNSW</a> here in Sydney, Australia. <a href="http://lists.apple.com/archives/Macos-x-server/2007/Jan/msg00606.html">Here&#8217;s the post I sent to macos-x-server@lists.apple.com about it</a>. Please contact me if you think you might be interested&#8230;</p>
<p>This probably means I&#8217;ll be a bit light on technical articles for this blog and <a href="http://afp548.com">afp548.com</a> for a while, but hopefully that won&#8217;t be a permanent state of affairs&#8230;</p>
<p>I&#8217;m not sure we can afford to live in Mountain View itself, and at this stage it looks like we might be looking around Sunnyvale, Santa Clara or San Jose. Useful suggestions for an ex-pat moving to the US and looking for housing would be much appreciated&#8230; :) Someone pointed me to <a href="http://housingmaps.com">housingmaps.com</a> which is rather cool, but it doesn&#8217;t seem like the local newspapers have sites like <a href="http://domain.com.au">domain.com.au</a> and <a href="http://www.realestate.com.au/">realestate.com.au</a> from poking around&#8230; </p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2007/01/29/leaving-sydney-moving-to-the-usa/#comments" title="Comment on Leaving Sydney&#8230; moving to the USA">View all 7 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-138" class="post-138 post type-post status-publish format-standard hentry category-ramblings category-snippets">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/12/22/heading-to-macworld/" rel="bookmark">Heading to MacWorld&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/12/22/heading-to-macworld/" title="Permalink to Heading to MacWorld&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-12-22T07:44:18+00:00">December 22, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/ramblings/" title="View all posts in ramblings" rel="category tag">ramblings</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/snippets/" title="View all posts in Snippets" rel="category tag">Snippets</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>Just as a quick note&#8230; </p>
<p>After spending four (maybe five if England can hold out that long) <b>glorious</b> days watching <a href="http://aus.cricinfo.com/australia/content/story/273509.html">Shane Warne&#8217;s last Test match</a> at the SCG, I&#8217;ll be flying straight out to San Francisco to <a href="http://www.macworldexpo.com/live/20/events/20SFO07A/SN363608/bio//CMONYA00BHX1">do some presentations at MacWorld</a>.</p>
<p>It&#8217;s always good to put faces to names, so if you&#8217;re around make sure to say hi, and even more importantly, make sure you make it to the <a href="http://www.afp548.com/article.php?story=20061106113640489&#038;query=macworld">AFP548 Kick-Off Session at Macworld</a>.</p>
<p>We can play the <a href="http://www.afp548.com/comment.php?mode=view&#038;cid=6614">drinking game every time Joel&#8217;s voice does that squeaky Jay Leno thing&#8230;</a> :)</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/12/22/heading-to-macworld/#comments" title="Comment on Heading to MacWorld&#8230;">One comment so far</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-137" class="post-137 post type-post status-publish format-standard hentry category-macosx category-software-and-scripts">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/30/making-parts-of-the-filesystem-readwrite-from-netboot/" rel="bookmark">Making parts of the filesystem read/write from NetBoot</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/30/making-parts-of-the-filesystem-readwrite-from-netboot/" title="Permalink to Making parts of the filesystem read/write from NetBoot" rel="bookmark"><time class="entry-date" datetime="2006-10-30T10:20:37+00:00">October 30, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts in software and scripts" rel="category tag">software and scripts</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So we use NetBoot (well NetInstall really) a lot here for diagnostics and as a platform for radminding machines from.</p>
<p>I&#8217;ve recently been refactoring our entire Radmind setup here, mainly because we&#8217;ve been using it for so long that we&#8217;re not actually taking advantage of any of the features Radmind has introduced in the last couple of years.</p>
<p>As part of this, I&#8217;ve been trying to avoid using our existing radmind wrapper script, and instead to try and do everything using the supplied ra.sh script, with appropriately configured preapply/postapply scripts, which is working rather nicely so far.</p>
<p>Anyway, to get to the point of this post, I worked out that if I wanted to use ra.sh while booted from a NetInstall image, I really needed /var/radmind to be read/write, which it isn&#8217;t.</p>
<p>After poking around through the /etc/rc.cdrom script, I noticed that Apple do things this way:</p>
<pre>
echo "Creating RAM Disk for /private/tmp"
dev=`hdik -drivekey system-image=yes -nomount ram://2048 `  # 1MB
if [ $? -eq 0 ] ; then
  newfs $dev
  mount -o union $dev /private/tmp
fi
</pre>
<p>which is all rather dandy when you think about it. hdik is creating a 1Mb RAM disk, and then it is mounted as a union mount at /private/tmp, effectively making that directory read/write.</p>
<p>The only problem is that our Radmind transcripts take up about 40-50Mb, and you can&#8217;t use hdik to make a RAM disk of that size, which I imagine is a limitation of the fact that hdik is intended for rather lightweight disk images, being an in-kernel tool and all.</p>
<p>So I started poking around trying to work out how to use hdiutil to accomplish the same thing, but it turns out that hdid is actually far simpler. Rather than being an in-kernel tool, it will actually use the DiskImages.framework, which means the disk image limitations don&#8217;t hold.</p>
<p>So here&#8217;s what I add to /etc/rc.cdrom.postWS to create 96Mb of r/w space in /var/radmind</p>
<pre>
# Create r/w mount for /var/radmind and populate it with the file structure
echo "Creating RAM disk for /var/radmind"
dev=`hdid -nomount ram://196608` # 96Mb
if [ $? -eq 0 ]; then
  newfs $dev
  mount -o union $dev /var/radmind
  mkdir /var/radmind/cert
  mkdir /var/radmind/client
  mkdir /var/radmind/postapply
  mkdir /var/radmind/preapply
fi
</pre>
<p>and now everything is peachy.</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/30/making-parts-of-the-filesystem-readwrite-from-netboot/#comments" title="Comment on Making parts of the filesystem read/write from NetBoot">View all 4 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-135" class="post-135 post type-post status-publish format-standard hentry category-macosxserver category-software-and-scripts">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/24/temporarily-swapping-user-passwords-in-open-directory/" rel="bookmark">Temporarily swapping user passwords in Open Directory</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/24/temporarily-swapping-user-passwords-in-open-directory/" title="Permalink to Temporarily swapping user passwords in Open Directory" rel="bookmark"><time class="entry-date" datetime="2006-10-24T09:37:21+00:00">October 24, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts in macosxserver" rel="category tag">macosxserver</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts in software and scripts" rel="category tag">software and scripts</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So something I find that I need to do quite often is to log in <b>as</b> a specific user, and I don&#8217;t always want to reset their password.</p>
<p>While AFP has a really useful function where you can allow admins of an AFP server to masquerade as a specific user by using the admin password, no other services really offer that same kind of functionality.</p>
<p>What I tend to do in these situations is to swap the Authentication Authority around. I keep a test user account around that I know the password to, and I swap its Authentication Authority with the user I need to login as.</p>
<p>As the Authentication Authority describes which Password Server slot contains the password for a given user, by swapping them around you are effectively swapping the passwords. If you&#8217;re in a nice Kerberized environment (and if you&#8217;re not, you should be&#8230;) then you&#8217;ll notice that this doesn&#8217;t actually swap the Kerberos passwords around.  This is because in a standard Open Directory setup, there are actually two password stores, one for Password Server and one for Kerberos. Apple have done some nifty stuff behind the scenes to keep the two in sync when users change their passwords, but by swapping Authentication Authorities around, you&#8217;re not modifying the Kerberos passwords at all.</p>
<p>Anyway, here&#8217;s the script I use to swap authentication authorities around.  I tend to save it as something like &#8220;swap_auth_authorities.sh&#8221;, and then you&#8217;d use it like:</p>
<pre>
./swap_auth_authorities.sh -n /LDAPv3/my.od.domain -a diradmin -p diradminpass  testone testtwo
</pre>
<p>which would swap the Authentication Authorities for the users &#8220;testone&#8221; and &#8220;testtwo&#8221;.</p>
<p>As always, don&#8217;t blame me if you blow up your server, and you should definitely try this on test accounts first&#8230;. You can use the command &#8220;/usr/libexec/chkpasswd testone&#8221; to test the passwords for each user. If you get &#8220;Sorry&#8221; back, the password is wrong, if you get nothing back, the password is correct.</p>
<p>Love that famed Apple user friendliness :)</p>
<p>Script follows, or <a href="files/swap_auth_authorities.sh.zip">you can download it here</a>:</p>
<pre>
#!/bin/bash
#

directorynode="/LDAPv3/127.0.0.1"
adminusername="diradmin"

export PATH="/usr/bin"

show_usage() {
echo "This script will swap the authentication authorities of two users in a directory node."
echo usage: swap_auth_authorities [-h] [-n directorynode] [-a adminusername] [-p adminpassword] username1 username2 ...
echo
echo "-h help (this output)"
echo "-n directory node name (default: /LDAPv3/127.0.0.1)"
echo "-a directory admin username (default: diradmin)"
echo "-p directory admin password"
echo "username1 and username2 are the users you wish to swap authentication authorities for"
echo 
echo "Note: If the admin password is not specified, you will be prompted for it a number of times."
}

show_password_prompt() {
  if [ ${#adminpassword} -eq 0 ]; then
    echo "Enter the password for $adminusername"
  fi
}

while getopts  "hn:a:p:" flag; do
  # echo "$flag" $OPTIND $OPTARG
  case "$flag" in
    h) show_usage; exit ;;
    n) directorynode="$OPTARG" ;;
    a) adminusername="$OPTARG" ;;
    p) adminpassword="$OPTARG" ;;
    ?) echo >&#038;2 "Illegal option '$OPTARG'"; exit 1 ;;
  esac
done
shift $(($OPTIND -1 ))

if [ $# -ne 2 ]; then
  echo >&#038;2 "Error: You should only pass two additional parameters, the usernames whose authentication authorities are to be swapped"
  echo 
  show_usage
  exit 1
fi

if [ ${#adminpassword} -eq 0 ]; then
  authstring="-u $adminusername -p"
  echo "You will now be prompted several times for the password for $adminusername"
else
  authstring="-u $adminusername -P $adminpassword"
fi


show_password_prompt
authority1=$(dscl $authstring $directorynode -read /Users/$1 AuthenticationAuthority | sed 's|^AuthenticationAuthority: ||g')

# check to see if users exist or permission denied.
if [ $? -ne 0 ]; then
  case $? in
    71 ) echo "User $1 not found in $directorynode"; exit 1 ;;
  esac
fi

# dscl really should return an error code in these cases...
if [ $(echo $authority1 | grep -c "Data source ($directorynode) is not valid.") -gt 0 ]; then
  echo "There is a problem with either your admin username/password combination, or the specified directory node"
  exit 1;
fi

show_password_prompt
authority2=$(dscl $authstring $directorynode -read /Users/$2 AuthenticationAuthority | sed 's|^AuthenticationAuthority: ||g')

# check to see if users exist or permission denied.
if [ $? -ne 0 ]; then
  case $? in
    71 ) echo "User $2 not found in $directorynode"; exit 1 ;;
  esac
fi

show_password_prompt
dscl $authstring $directorynode -create /Users/$1 AuthenticationAuthority "$authority2"

show_password_prompt
dscl $authstring $directorynode -create /Users/$2 AuthenticationAuthority "$authority1"

echo "The authentication authorities for $1 and $2 have been swapped."
echo "Note that Kerberos authentication will continue to use the old passwords."
echo "If you re-run this command, the authentication authorities will be swapped back again."
</pre>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/24/temporarily-swapping-user-passwords-in-open-directory/#comments" title="Comment on Temporarily swapping user passwords in Open Directory">View all 6 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-134" class="post-134 post type-post status-publish format-standard hentry category-ramblings category-snippets">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/18/typos-can-be-fatal/" rel="bookmark">Typos can be fatal&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/18/typos-can-be-fatal/" title="Permalink to Typos can be fatal&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-10-18T07:49:46+00:00">October 18, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/ramblings/" title="View all posts in ramblings" rel="category tag">ramblings</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/snippets/" title="View all posts in Snippets" rel="category tag">Snippets</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So last night I was playing around with the MBR on an external drive&#8230; and completely without thinking managed to wipe out my laptop.</p>
<p><b>/dev/rdisk1</b> Nigel, not /dev/rdisk0 &#8230;.</p>
<p>bleagh.</p>
<p>Anyway, it&#8217;s made me realise just how much I love HomeSync, as 95% of everything that matters has been syncing up to the server&#8230; and as I&#8217;ve had two requests now for a post on Mobile Accounts and HomeSync best practices, this is as good a time as any&#8230; working on it now while watching OS X and Win XP reinstall&#8230;. </p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/10/18/typos-can-be-fatal/#comments" title="Comment on Typos can be fatal&#8230;">View all 5 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-132" class="post-132 post type-post status-publish format-standard hentry category-macosx category-software-and-scripts">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/28/wtfdtfd-a-wiki-like-system-for-the-mac-os-x-file-system/" rel="bookmark">wtfdtfd ? : A wiki-like system for the Mac OS X file system&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/28/wtfdtfd-a-wiki-like-system-for-the-mac-os-x-file-system/" title="Permalink to wtfdtfd ? : A wiki-like system for the Mac OS X file system&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-09-28T07:24:58+00:00">September 28, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts in macosx" rel="category tag">macosx</a>, <a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts in software and scripts" rel="category tag">software and scripts</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So I&#8217;m rather close to deploying a closed beta test of something that I&#8217;ve been working on in my spare time for a while now.</p>
<p>The basic idea is that you can browse a copy of the Mac OS X filesystem, and any registered user can attach &#8220;annotations&#8221; to a file or directory explaining what that file does. This is done with a wiki-like system, so any user can edit the annotations, or roll back to previous versions.</p>
<p>The main impetus behind this was me trying to train up someone at work to take over the radmind setup we have.  It really doesn&#8217;t take long to learn how something like radmind works, but what does take time is working out exactly what files <b>do</b>, and whether you should include a particular file in any given transcript or not.</p>
<p>Thus the name &#8220;wtfdtfd&#8221; ==  &#8220;wtf does this file do?&#8221; &#8230;</p>
<p>It&#8217;s also been a way for me to finally start a proper project in Ruby on Rails, which I&#8217;ve been meaning to do for a while now.</p>
<p>I&#8217;ll be opening up the source to interested people after I deploy it, so if you&#8217;re interested in taking part in either coding or a private beta, send me an email by clicking on the &#8220;About&#8221; tab at the top.</p>
<p><b>Edit</b>:<br />
If you want to take part, the easiest way is to subscribe to the dev-list, which you can do by clicking on this link.</p>
<p>
<a href="mailto:dev-list-request@wtfdtfd.explanatorygap.net?subject=subscribe">Subscribe to wtfdtfd dev-list</a></p>
<p>Thanks for the input people, it&#8217;s looking good&#8230;. :)</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/28/wtfdtfd-a-wiki-like-system-for-the-mac-os-x-file-system/#comments" title="Comment on wtfdtfd ? : A wiki-like system for the Mac OS X file system&#8230;">View all 3 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-128" class="post-128 post type-post status-publish format-standard hentry category-ramblings">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/18/welcome-to-the-new-blog/" rel="bookmark">Welcome to the new blog&#8230;</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/18/welcome-to-the-new-blog/" title="Permalink to Welcome to the new blog&#8230;" rel="bookmark"><time class="entry-date" datetime="2006-09-18T20:51:23+00:00">September 18, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/ramblings/" title="View all posts in ramblings" rel="category tag">ramblings</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>So here&#8217;s the new blog&#8230; I finally bit the bullet and bought some hosting space&#8230; and man, things have changed in the 9 or so years since I last did this&#8230; The prices are insanely low for what you get&#8230; and everyone has these beautiful cPanel/Fantastico style auto-installers.</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/18/welcome-to-the-new-blog/#comments" title="Comment on Welcome to the new blog&#8230;">View all 8 comments</a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
							
<article id="post-88" class="post-88 post type-post status-publish format-standard hentry category-macosxserver">
	<header class="entry-header">
		
				<h1 class="entry-title">
			<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/06/new-afp-tuning-article-up-on-afp548com/" rel="bookmark">New AFP &quot;tuning&quot; article up on afp548.com</a>
		</h1>
		
		<div class="entry-meta">
			<span class="date"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/06/new-afp-tuning-article-up-on-afp548com/" title="Permalink to New AFP &quot;tuning&quot; article up on afp548.com" rel="bookmark"><time class="entry-date" datetime="2006-09-06T00:44:35+00:00">September 6, 2006</time></a></span><span class="categories-links"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts in macosxserver" rel="category tag">macosxserver</a></span><span class="author vcard"><a class="url fn n" href="http://explanatorygap.net/wp-content/plugins/really-static/static/author/nigelkersten/" title="View all posts by nigel kersten" rel="author">nigel kersten</a></span>					</div><!-- .entry-meta -->
	</header><!-- .entry-header -->

		<div class="entry-content">
		<p>&#8220;Tuning&#8221; is in quotes because&#8230; well you&#8217;ll see once you read the article. :)</p>
<p>Go check it out <a href="http://www.afp548.com/article.php?story=20060905144209269">at afp548.com</a>, which you should all be reading religiously anyway. :)</p>
			</div><!-- .entry-content -->
	
	<footer class="entry-meta">
					<div class="comments-link">
				<a href="http://explanatorygap.net/wp-content/plugins/really-static/static/2006/09/06/new-afp-tuning-article-up-on-afp548com/#respond" title="Comment on New AFP &quot;tuning&quot; article up on afp548.com"><span class="leave-reply">Leave a comment</span></a>			</div><!-- .comments-link -->
		
			</footer><!-- .entry-meta -->
</article><!-- #post -->
			
				<nav class="navigation paging-navigation" role="navigation">
		<h1 class="screen-reader-text">Posts navigation</h1>
		<div class="nav-links">

						<div class="nav-previous"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/page/6/index.html" ><span class="meta-nav">&larr;</span> Older posts</a></div>
			
						<div class="nav-next"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/page/4/index.html" >Newer posts <span class="meta-nav">&rarr;</span></a></div>
			
		</div><!-- .nav-links -->
	</nav><!-- .navigation -->
	
		
		</div><!-- #content -->
	</div><!-- #primary -->


		</div><!-- #main -->
		<footer id="colophon" class="site-footer" role="contentinfo">
				<div id="secondary" class="sidebar-container" role="complementary">
		<div class="widget-area">
			<aside id="pages-2" class="widget widget_pages"><h3 class="widget-title">Pages</h3>		<ul>
			<li class="page_item page-item-2"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/about/">About/Contact</a></li>
<li class="page_item page-item-278"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/os-x-puppet-pkgs/">OS X Puppet pkgs</a></li>
		</ul>
		</aside><aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="http://explanatorygap.net/wp-content/plugins/really-static/static/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" title="Search for:" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside><aside id="tweetbox" class="widget tweetbox_widget"><h3 class="widget-title">Latest Tweets</h3><script type="text/javascript" src="http://explanatorygap.net/wp-content/plugins/tweetbox/tweetbox.js"></script><script>getTweets('nigelkersten', 3, '')</script><div id="tweetboxtweets">Fetching latest tweets...</div></aside><aside id="categories-1" class="widget widget_categories"><h3 class="widget-title">Categories</h3>		<ul>
	<li class="cat-item cat-item-5"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/nix/" title="View all posts filed under *nix">*nix</a>
</li>
	<li class="cat-item cat-item-6"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosx/" title="View all posts filed under macosx">macosx</a>
</li>
	<li class="cat-item cat-item-3"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/macosxserver/" title="View all posts filed under macosxserver">macosxserver</a>
</li>
	<li class="cat-item cat-item-13"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/puppet/" title="View all posts filed under puppet">puppet</a>
</li>
	<li class="cat-item cat-item-15"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/python/" title="View all posts filed under python">python</a>
</li>
	<li class="cat-item cat-item-4"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/ramblings/" title="View all posts filed under ramblings">ramblings</a>
</li>
	<li class="cat-item cat-item-2"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/snippets/" title="Snippets">Snippets</a>
</li>
	<li class="cat-item cat-item-7"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/software-and-scripts/" title="View all posts filed under software and scripts">software and scripts</a>
</li>
	<li class="cat-item cat-item-1"><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/category/uncategorized/" title="View all posts filed under Uncategorized">Uncategorized</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h3 class="widget-title">Meta</h3>			<ul>
						<li><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/wp-login.php">Log in</a></li>
			<li><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/feed/" title="Syndicate this site using RSS 2.0">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="http://explanatorygap.net/wp-content/plugins/really-static/static/comments/feed/" title="The latest comments to all posts in RSS">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
</aside><aside id="linkcat-10" class="widget widget_links"><h3 class="widget-title">Mac Dev Blogs</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://ridiculousfish.com/blog/">Ridiculous Fish</a></li>
<li><a href="http://www.theocacao.com/" title="Scott Stevenson&#8217;s blog">theocacao.com</a></li>

	</ul>
</aside>
<aside id="linkcat-8" class="widget widget_links"><h3 class="widget-title">Mac Tech Blogs</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://bynkii.com/" title="John C. Welch&#8217;s blog&#8230; the reason God invented the middle finger&#8230;">bynkii.com</a></li>
<li><a href="http://arstechnica.com/staff/fatbits.ars" title="John Siracusa&#8217;s Journal">fatbits</a></li>
<li><a href="http://iamleeg.blogspot.com/" title="Graham Lee&#8217;s blog&#8230; lots of Darwin and Openstep.">i am leeg</a></li>
<li><a href="http://managingosx.wordpress.com/" title="Greg Neagle&#8217;s Managing OS X blog">managing os x</a></li>
<li><a href="http://northstarlabs.net" title="Jeff McCune&#8217;s sysadmin blog">northstarlabs.net</a></li>
<li><a href="http://www.radiotope.com/writing/" title="Edward Marczak&#8217;s blog&#8230; the oneness of tech..">tech zendo</a></li>
<li><a href="http://www.dreness.com/blog/" title="Andre&#8217;s Mac geek blog&#8230;">the bits</a></li>
<li><a href="http://yourmacguy.wordpress.com/" title="Peter Bukowinski&#8217;s blog">Your Mac Guy</a></li>

	</ul>
</aside>
<aside id="linkcat-9" class="widget widget_links"><h3 class="widget-title">Mac Technical Sites</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://www.afp548.com" title="We put the M in RTFM&#8230;">AFP548.com</a></li>
<li><a href="http://www.macenterprise.org" title="The MacEnterprise project is a community of IT professionals sharing information and solutions to support Macs in an enterprise.">MacEnterprise.org</a></li>
<li><a href="http://xsanity.com/">xsanity</a></li>

	</ul>
</aside>
<aside id="linkcat-12" class="widget widget_links"><h3 class="widget-title">Social</h3>
	<ul class='xoxo blogroll'>
<li><a href="http://yumamino.com/" title="Tane Potaka&#8217;s blog">Yumamino</a></li>

	</ul>
</aside>
		</div><!-- .widget-area -->
	</div><!-- #secondary -->

			<div class="site-info">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a>
			</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #page -->

	<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/masonry.min.js?ver=3.1.2'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-includes/js/jquery/jquery.masonry.min.js?ver=3.1.2'></script>
<script type='text/javascript' src='http://explanatorygap.net/wp-content/themes/twentythirteen/js/functions.js?ver=2013-07-18'></script>
</body>
</html>
<!-- Dynamic Page Served (once) in 0.336 seconds -->
